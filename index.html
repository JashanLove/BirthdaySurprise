<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Birthday Surprise</title>
<style>
  :root{
    --bg1:#fff0f5; --accent:#ff4081;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(135deg,#ffd6e0,#fff0f5);
    color:#3b2b2b;
    overflow:hidden;
    padding:32px;
  }

  /* page layout container keeps everything centered vertically */
  .stage {
    width:100%;
    max-width:920px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:20px;
  }

  /* "Here's a gift..." header above the gift */
  .gift-header{
    font-size:20px;
    color:var(--accent);
    font-weight:700;
    text-align:center;
    margin-top:6px;
  }

  /* gift SVG container */
  .gift-svg {
    width:160px;
    height:160px;
    cursor:pointer;
    perspective:800px;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .gift-svg:hover{ transform: translateY(-4px); transition: transform 180ms ease; }

  /* letter container - centered and on top */
  #letterContainer{
    display:none;              /* shown after reveal */
    width:100%;
    align-items:center;
    justify-content:center;
    flex-direction:column;
    z-index:3;
  }
  #letterContainer p{
    margin:6px 0 12px;
    color:#7a5a66;
    font-weight:600;
  }
  #letterImage{
    width:86%;
    max-width:520px;
    border-radius:12px;
    box-shadow: 0 18px 40px rgba(255,80,120,0.06);
  }

  /* love text directly under the letter, centered */
  #loveText{
    display:none;
    margin-top:18px;
    font-size:28px;
    font-weight:800;
    text-align:center;
    background: linear-gradient(90deg,#ff3366,#ff66b2,#ff99c7);
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
    filter: drop-shadow(0 6px 18px rgba(255,50,120,0.12));
  }

  /* sparkle line shown briefly after click */
  #sparkleText{
    display:none;
    font-size:28px;
    font-weight:800;
    color: #ff66b2;
    text-align:center;
    text-shadow: 0 0 6px rgba(255,102,178,0.8);
  }

  /* hearts layer - behind letter but above background */
  .hearts {
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:2;
    overflow:hidden;
  }
  .heart {
    position:absolute;
    bottom:-40px;
    font-size:20px;
    animation: rise 6s linear forwards;
    opacity:0.95;
  }
  @keyframes rise {
    0% { transform: translateY(0) scale(1); opacity:1; }
    100% { transform: translateY(-110vh) scale(1.4); opacity:0; }
  }

  /* simple responsive tweak */
  @media (max-width:520px){
    .gift-svg{ width:130px; height:130px; }
    #sparkleText{ font-size:20px; }
    #loveText{ font-size:20px; }
  }
</style>
</head>
<body>

<audio id="bgMusic" preload="auto" src="https://github.com/JashanLove/BirthdaySurprise/raw/main/piano.mp3"></audio>

<div class="stage">
  <!-- header text above gift -->
  <div class="gift-header" id="giftHeader">Here's a gift for you üéÅ</div>

  <!-- gift SVG (clickable) -->
  <div class="gift-svg" id="giftBox" aria-label="Gift box - click to open">
    <svg viewBox="0 0 200 200" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" role="img">
      <ellipse cx="100" cy="170" rx="48" ry="10" fill="rgba(0,0,0,0.12)"/>
      <g id="lidGroup">
        <rect id="lidRect" x="25" y="10" width="150" height="40" rx="8" ry="8" fill="#ff80bf" stroke="#ff4da6" stroke-width="1.8"/>
        <g transform="translate(100,30) rotate(0)">
          <path d="M-6 -2 C -18 -12 -28 -2 -6 10" fill="#ff4da6"/>
          <path d="M6 -2 C 18 -12 28 -2 6 10" fill="#ff4da6"/>
        </g>
      </g>

      <rect x="20" y="45" width="160" height="110" rx="10" ry="10" fill="url(#boxGrad)" stroke="#ff3366" stroke-width="1.6"/>
      <rect x="95" y="45" width="18" height="110" fill="#fff"/>
      <rect x="20" y="95" width="160" height="18" fill="#fff"/>
      <defs>
        <linearGradient id="boxGrad" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0" stop-color="#ff5f9e"/>
          <stop offset="1" stop-color="#ff2e74"/>
        </linearGradient>
      </defs>
    </svg>
  </div>

  <!-- sparkle text -->
  <div id="sparkleText">üéâ Happy Birthday Dalvi üéâ</div>

  <!-- letter (centered) -->
  <div id="letterContainer">
    <p>Here's a letter for you üíå</p>
    <img id="letterImage" src="https://raw.githubusercontent.com/JashanLove/BirthdaySurprise/main/letter.jpg" alt="Handwritten letter">
    <div id="loveText">I love you Bandri ‚ù§Ô∏è</div>
  </div>
</div>

<!-- hearts layer behind the letter (z-index 2) -->
<div class="hearts" id="heartsLayer"></div>

<script>
  const giftBox = document.getElementById('giftBox');
  const lidGroup = document.getElementById('lidGroup');
  const sparkleText = document.getElementById('sparkleText');
  const letterContainer = document.getElementById('letterContainer');
  const loveText = document.getElementById('loveText');
  const heartsLayer = document.getElementById('heartsLayer');
  const bgMusic = document.getElementById('bgMusic');
  const giftHeader = document.getElementById('giftHeader');

  // helper to spawn hearts
  function spawnHeart() {
    const el = document.createElement('div');
    el.className = 'heart';
    el.textContent = (Math.random() < 0.5) ? 'üíó' : 'üíû';
    el.style.left = Math.random() * 80 + 10 + 'vw';
    el.style.bottom = -30 + 'px';
    el.style.fontSize = (14 + Math.random()*18) + 'px';
    el.style.animationDuration = (4 + Math.random()*4) + 's';
    heartsLayer.appendChild(el);
    setTimeout(()=> el.remove(), 7000);
  }

  let heartsInterval;

  // particle canvas (for sparkly burst)
  const canvas = document.createElement('canvas');
  canvas.style.position = 'fixed';
  canvas.style.left = 0;
  canvas.style.top = 0;
  canvas.style.pointerEvents = 'none';
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  canvas.style.zIndex = 1;
  document.body.appendChild(canvas);
  const ctx = canvas.getContext('2d');

  let particles = [];
  function createParticles(x,y){
    for(let i=0;i<18;i++){
      particles.push({
        x, y,
        vx:(Math.random()-0.5)*6,
        vy:(Math.random()-1.5)*6,
        r:1+Math.random()*3,
        life:50+Math.random()*30,
        color:`hsl(${Math.random()*360},80%,65%)`
      });
    }
  }
  function animParticles(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(let i=particles.length-1;i>=0;i--){
      const p = particles[i];
      ctx.beginPath();
      ctx.fillStyle = p.color;
      ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fill();
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.05;
      p.life--;
      if(p.life<=0) particles.splice(i,1);
    }
    requestAnimationFrame(animParticles);
  }
  animParticles();
  window.addEventListener('resize', ()=>{ canvas.width = innerWidth; canvas.height = innerHeight; });

  // open sequence
  let opened = false;
  giftBox.addEventListener('click', async (e) => {
    if(opened) return;
    opened = true;

    // user gesture -> start music
    try { await bgMusic.play(); } catch(e) { /* ignore */ }

    // rotate lidGroup visually (best-effort): animate transform attribute
    let angle = 0, target = -120;
    const anim = setInterval(()=>{
      angle -= 12;
      if(angle <= target){ angle = target; clearInterval(anim); }
      // apply a transform on the group
      lidGroup.setAttribute('transform', `translate(0,0) rotate(${angle} 100 30)`);
      // also apply quick style fallback
      const lidRect = document.getElementById('lidRect');
      if(lidRect) lidRect.style.transform = `perspective(400px) rotateX(${angle}deg)`;
    }, 30);

    // show sparkle text and particle bursts
    sparkleText.style.display = 'block';
    // small bursts near center
    const cx = innerWidth/2, cy = innerHeight/2 - 40;
    const burst = setInterval(()=> createParticles(cx + (Math.random()-0.5)*120, cy + (Math.random()-0.5)*80), 110);

    // after 5s, stop sparkle and reveal letter centered, hide gift and header
    setTimeout(()=>{
      clearInterval(burst);
      sparkleText.style.display = 'none';

      // hide gift and header completely so they don't overlap
      giftBox.style.display = 'none';
      giftHeader.style.display = 'none';

      // reveal letter and love text
      letterContainer.style.display = 'flex';
      loveText.style.display = 'block';

      // start gentle hearts
      heartsInterval = setInterval(spawnHeart, 500);

    }, 5000);

  });

</script>
</body>
</html>
